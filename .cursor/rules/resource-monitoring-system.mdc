---
description: Specification for GPU resource monitoring and telemetry collection system with real-time metrics tracking and alert mechanisms
globs: **/telemetry.py,**/metrics.py,**/gpu_info.py,**/memory_monitor.py,**/dashboard.py
alwaysApply: false
---


# resource-monitoring-system

The resource monitoring system provides real-time GPU telemetry collection and metrics tracking with alert capabilities.

Core Components:

### GPU Telemetry Collection
- Implements NVML-based polling generator for GPU metrics
- Collects utilization, memory usage, PCIe throughput, temperature, power usage, fan speed, clock speeds
- Provides configurable update intervals for different metrics
- Maintains rolling window of historical data (60 sample points)

### Memory Monitoring System 
- Defines four alert levels: Normal, Warning, Critical, Emergency
- Tracks per-model memory profiles including:
  - Base memory usage
  - Per-batch memory growth
  - Per-token memory requirements
- Implements predictive OOM prevention using historical patterns
- Progressive threshold monitoring with customizable trigger points

### Resource Optimization
- Calculates maximum safe batch sizes based on:
  - Model memory profiles
  - Available VRAM
  - Growth patterns
  - Safety margins
- Provides memory-aware context size recommendations
- Implements batch size auto-adjustment based on memory pressure

### Alert System
- Progressive alert thresholds for:
  - Memory utilization
  - Temperature limits  
  - Power consumption
  - Performance degradation
- Four-tier recovery strategy:
  1. Cache clearing
  2. Batch reduction
  3. Memory offloading
  4. Process termination

Relevant File Paths:
- `dualgpuopt/telemetry.py`
- `dualgpuopt/memory_monitor.py`
- `dualgpuopt/metrics.py`
- `dualgpuopt/gpu_info.py`

$END$