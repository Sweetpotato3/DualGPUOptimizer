---
description: Documents data flow patterns for GPU resource optimization, telemetry, and monitoring metrics across multi-GPU systems
globs: **/dualgpuopt/**/*.py,**/integrated_app/**/*.py
alwaysApply: false
---


# data-flow-architecture

Core Data Flows:

1. GPU Resource Metrics Flow
- Source: GPU hardware telemetry (dualgpuopt/telemetry.py)
- Flow: Hardware metrics -> Telemetry Service -> Event Bus -> Dashboard
- Key metrics:
  * GPU/Memory utilization 
  * Temperature and power consumption
  * Clock speeds and fan status
  * PCIe bandwidth usage

2. Optimization Parameter Flow
- Source: Optimizer configuration (dualgpuopt/optimizer.py)
- Flow: User input -> Optimizer -> Command Generator -> Model Runner
- Parameters:
  * GPU memory split ratios
  * Tensor parallel fractions
  * Context size constraints
  * Layer distribution weights

3. GPU State Management Flow
- Source: GPU hardware state (dualgpuopt/services/state_service.py)
- Flow: GPU State -> Event Bus -> Services -> UI Components
- States:
  * Overclocking profiles
  * Power/thermal limits
  * Memory allocation status
  * Idle detection flags

4. Model Deployment Flow
- Source: Model configuration (dualgpuopt/gui/launcher.py)
- Flow: Model params -> Optimizer -> Framework-specific commands -> GPU execution
- Configuration:
  * Framework selection (llama.cpp/vLLM)
  * GPU split configuration
  * Memory allocation strategy
  * Tensor parallel settings

Key Integration Points:

1. Telemetry Pipeline
```
GPU Hardware -> NVML Interface -> Telemetry Service -> Event Bus -> Monitoring Dashboard
```

2. Optimization Pipeline
```
User Input -> Optimizer -> Command Generator -> Framework Runner -> GPUs
```

3. State Management Pipeline
```
GPU State Changes -> Event Bus -> State Service -> UI Components
```

Critical Data Structures:

1. GPUMetrics
- Utilization percentages
- Memory usage stats
- Temperature/power data
- Clock/fan speeds
- PCIe bandwidth metrics

2. OptimizationParameters  
- Memory split ratios
- Tensor fractions
- Context sizes
- Layer distribution

3. GPUState
- Hardware settings
- Power profiles
- Memory allocation
- Idle status

$END$