---
description: Documents data flow between GPU optimization components, including resource metrics, parameters, and monitoring data
globs: dualgpuopt/**/*.py,integrated_app/**/*.py
alwaysApply: false
---


# data-flow-architecture

Core Data Flow Components:

1. GPU Metrics Collection Pipeline
- GPU hardware telemetry data flows from NVML/hardware drivers to telemetry service 
- Real-time metrics include: utilization, memory usage, temperature, power, clocks
- Middleware pipeline transforms and routes metrics to subscribed components 
- fallback data generation for mock mode when hardware access unavailable

2. Memory Flow Analysis
- Memory profiler tracks allocation/deallocation events across inference sessions
- Event classification and anomaly detection system categorizes:
  * Memory spikes above spike_threshold MB/s
  * Leaks with sustained growth above leak_threshold MB/s
  * Memory retention patterns after inference
- Memory metrics flow to dashboard and optimizer components

3. Model Parameter Flow
- Configuration service manages model parameters and GPU splits
- Preset configurations flow to optimizer for different architectures:
  * Context length requirements
  * Hidden dimensions
  * Layer counts
  * Attention head configurations 
- Optimizer generates framework-specific commands for llama.cpp/vLLM

4. Event Bus Architecture
- Centralized event bus coordinates data flow between components
- Event categories:
  * GPUEvent: Hardware state changes
  * GPUMetricsEvent: Performance metrics
  * OptimizationEvent: Resource allocation updates
- Priority-based event routing with 4 levels (LOW to CRITICAL)

5. Configuration Flow
- Config service provides persistent storage for:
  * GPU overclock profiles
  * Idle detection thresholds
  * Model presets and parameters
  * Theme/appearance settings
- Changes propagate through event bus to affected components

Key Data Flow Paths:
```
GPU Hardware -> Telemetry Service -> Event Bus -> Dashboard/Optimizer
Memory Profiler -> Event Bus -> Dashboard/Memory Tab
Config Service -> Event Bus -> All Components
```

Core Files:
- dualgpuopt/services/event_bus.py
- dualgpuopt/memory/profiler.py
- dualgpuopt/telemetry.py
- dualgpuopt/services/config_service.py

$END$